{% extends 'admin/base.html' %}
{% block content %}
    <!-- loader Start -->
    <div id="loading">
          <div id="loading-center">
          </div>
    </div>
    <!-- loader END -->
    <!-- Wrapper Start -->
    <div class="wrapper">
      
      <div class="iq-sidebar  sidebar-default ">
              <div class="iq-sidebar-logo d-flex align-items-center justify-content-between">
              <a href="{{ url_for('admin.admin_index') }}" class="header-logo">
                  <img src="{{ url_for('static', filename='accssets/logo-chothuexemayanhkhanh.png') }}" class="img-fluid rounded-normal light-logo" alt="logo" style="max-height: 60px; width: auto;">
               </a>
              <div class="iq-menu-bt-sidebar">
                  <i class="las la-bars wrapper-menu"></i>
              </div>
          </div>
          <div class="data-scrollbar" data-scroll="1">
              <nav class="iq-sidebar-menu">
                  <ul id="iq-sidebar-toggle" class="iq-menu">
                       <li class="{% if request.endpoint == 'admin.admin_index' %}active{% endif %}">
                              <a href="{{ url_for('admin.admin_index') }}" class="{% if request.endpoint == 'admin.admin_index' %}active{% endif %}">
                                  <i class="las la-home iq-arrow-left"></i><span>Bảng điều khiển</span>
                              </a>
                          <ul id="dashboard" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.catagories_motorcycle' %}active{% endif %}">
                              <a href="{{ url_for('admin.catagories_motorcycle') }}" class="{% if request.endpoint and request.endpoint.startswith('admin.motor') and not request.endpoint.startswith('admin.detail_motorcycle') %}active{% endif %}">
                                  <i class="las la-list-ul iq-arrow-left"></i><span>Quản lý loại xe</span>
                              </a>
                          <ul id="page-files" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.motorcycles' %}active{% endif %}">
                              <a href="{{ url_for('admin.motorcycles') }}" class="{% if request.endpoint and request.endpoint.startswith('admin.detail_motorcycle') %}active{% endif %}">
                                  <i class="las la-motorcycle iq-arrow-left"></i><span>Quản lý xe</span>
                              </a>
                          <ul id="detail-motorcycle" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.articles' %}active{% endif %}">
                              <a href="{{ url_for('admin.articles') }}" class="">
                                  <i class="las la-newspaper iq-arrow-left"></i><span>Quản lý bài viết</span>
                              </a>
                          <ul id="page-folders" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                        <li class="{% if request.endpoint == 'admin.store_info' %}active{% endif %}">
                            <a href="{{ url_for('admin.store_info') }}" class="">
                                  <i class="las la-store iq-arrow-left"></i><span>Thông tin cửa hàng</span>
                              </a>
                          <ul id="page-folders" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.customers' or request.endpoint == 'admin.customer_detail' %}active{% endif %}">
                            <a href="{{ url_for('admin.customers') }}" class="">
                                  <i class="las la-user-friends iq-arrow-left"></i><span>Quản lý khách hàng</span>
                              </a>
                          <ul id="page-customers" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.rentals' or request.endpoint == 'admin.rental_detail' or request.endpoint == 'admin.rental_update_status' %}active{% endif %}">
                            <a href="{{ url_for('admin.rentals') }}" class="">
                                  <i class="las la-file-invoice iq-arrow-left"></i><span>Quản lý đơn thuê</span>
                              </a>
                          <ul id="page-rentals" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                       <li class="{% if request.endpoint == 'admin.payments' or request.endpoint == 'admin.payment_detail' %}active{% endif %}">
                            <a href="{{ url_for('admin.payments') }}" class="">
                                  <i class="las la-credit-card iq-arrow-left"></i><span>Quản lý giao dịch</span>
                              </a>
                          <ul id="page-payments" class="iq-submenu collapse" data-parent="#iq-sidebar-toggle">
                          </ul>
                       </li>
                  </ul>
              </nav>
              <div class="sidebar-bottom">
              </div>
              <div class="p-3"></div>
          </div>
          </div>       <div class="iq-top-navbar">
          <div class="iq-navbar-custom">
              <nav class="navbar navbar-expand-lg navbar-light p-0">
              <div class="iq-navbar-logo d-flex align-items-center justify-content-between">
                  <i class="ri-menu-line wrapper-menu"></i>
                  <a href="{{ url_for('admin.admin_index') }}" class="header-logo">
                      <img src="{{ url_for('static', filename='accssets/logo-chothuexemayanhkhanh.png') }}" class="img-fluid rounded-normal light-logo" alt="logo" style="max-height: 40px; width: auto;">
                      <img src="{{ url_for('static', filename='accssets/logo-chothuexemayanhkhanh.png') }}" class="img-fluid rounded-normal darkmode-logo" alt="logo" style="max-height: 40px; width: auto;">
                  </a>
              </div>
                  <div class="iq-search-bar device-search">
                      
                      <form>
                          <div class="input-prepend input-append">
                              <div class="btn-group">
                                  <label class="dropdown-toggle searchbox" data-toggle="dropdown">
                                  <input class="dropdown-toggle search-query text search-input" type="text"  placeholder="Nhập vào tìm kiếm..."><span class="search-replace"></span>
                                  <a class="search-link" href="#"><i class="ri-search-line"></i></a>
                                  <span class="caret"><!--icon--></span>
                                  </label>
                              </div>
                          </div>
                      </form>
                  </div>
      
                  <div class="d-flex align-items-center">
                      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"  aria-label="Toggle navigation">
                      <i class="ri-menu-3-line"></i>
                      </button>
                      <div class="collapse navbar-collapse" id="navbarSupportedContent">
                          <ul class="navbar-nav ml-auto navbar-list align-items-center">
                          <li class="nav-item nav-icon search-content">
                              <a href="#" class="search-toggle rounded" id="dropdownSearch" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                  <i class="ri-search-line"></i>
                              </a>
                              <div class="iq-search-bar iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownSearch">
                                  <form action="#" class="searchbox p-2">
                                      <div class="form-group mb-0 position-relative">
                                      <input type="text" class="text search-input font-size-12" placeholder="type here to search...">
                                      <a href="#" class="search-link"><i class="las la-search"></i></a> 
                                      </div>
                                  </form>
                              </div>
                          </li> 
                          <li class="nav-item nav-icon dropdown">
                              <a href="#" class="search-toggle dropdown-toggle" id="dropdownMenuButton01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              <i class="ri-question-line"></i>
                              </a>
                              <div class="iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownMenuButton01">
                                  <div class="card shadow-none m-0">
                                      <div class="card-body p-0 ">
                                    
                                      </div>
                                  </div>
                              </div>
                          </li>
                          <li class="nav-item nav-icon dropdown"> 
                              <a href="#" class="search-toggle dropdown-toggle" id="dropdownMenuButton02" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" >
                              <i class="ri-settings-3-line"></i>
                              </a>
                              <div class="iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownMenuButton02">
                                  <div class="card shadow-none m-0">
                                      <div class="card-body p-0 ">                            
                                      </div>
                                  </div>
                              </div>
                          </li>
                          <li class="nav-item nav-icon dropdown caption-content">
                              <a href="#" class="search-toggle dropdown-toggle" id="dropdownMenuButton03" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" >
                                  <div class="caption bg-primary line-height">{{ session.get('account_full_name', 'A')[0] | upper }}
                                    </div>
                              </a>
                              <div class="iq-sub-dropdown dropdown-menu" aria-labelledby="dropdownMenuButton03">
                                  <div class="card mb-0">
                                      <div class="card-header d-flex justify-content-between align-items-center mb-0">
                                      <div class="header-title">
                                          <h4 class="card-title mb-0">Thông tin</h4>
                                      </div>
                                      <div class="close-data text-right badge badge-primary cursor-pointer "><i class="ri-close-fill"></i></div>
                                      </div>
                                      <div class="card-body">
                                          <div class="profile-header">
                                              <div class="cover-container text-center">
                                                  <div class="rounded-circle profile-icon bg-primary mx-auto d-block">
                                                      {{ session.get('account_full_name', 'A')[0]|upper}}                                                
                                                      <a href="">
                                                          
                                                      </a>
                                                  </div>
                                                  <div class="profile-detail mt-3">
                                                  <h5><a href="../app/user-profile-edit.html">{{ session.get('account_full_name', 'Guest') }}</a></h5>
                                                  <p>{{ session.get('account_username', 'error@gmail.com') }}</p>
                                                  </div>
                                                  <a href="{{ url_for('admin.admin_logout') }}" class="btn btn-primary">Đăng xuất</a>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </li>
                          </ul>                     
                      </div> 
                  </div>
              </nav>
          </div>
      </div>
        {% block page_content %}
        {% endblock %}

<!-- Site-wide confirmation modal (used for custom confirm instead of browser confirm) -->
<div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmModalLabel">Xác nhận</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p id="confirmModalMessage">Bạn có chắc chắn muốn thực hiện hành động này?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
        <button type="button" id="confirmModalBtn" class="btn btn-danger">Xác nhận</button>
      </div>
    </div>
  </div>
</div>

<script>
// Delegated handler: forms with class "confirm-delete" will show the site modal.
(function($){
  let pendingForm = null;

  $(document).on('submit', 'form.confirm-delete', function(e){
    const $form = $(this);
    // If already confirmed, allow submit (remove flag and continue)
    if ($form.data('confirmed')) {
      $form.data('confirmed', false);
      return true;
    }
    e.preventDefault();
    pendingForm = $form;
    const message = $form.data('confirm-message') || 'Bạn có chắc chắn muốn xóa?';
    $('#confirmModalMessage').text(message);
    $('#confirmModal').modal('show');
  });

  // Confirm button -> mark form confirmed then submit
  $('#confirmModalBtn').on('click', function(){
    if (!pendingForm) {
      $('#confirmModal').modal('hide');
      return;
    }
    pendingForm.data('confirmed', true);
    $('#confirmModal').modal('hide');
    // trigger submit again (will bypass due to data-confirmed flag)
    setTimeout(function(){
      pendingForm.trigger('submit');
      pendingForm = null;
    }, 50);
  });

  // clear pending if modal closed by other means
  $('#confirmModal').on('hidden.bs.modal', function(){
    pendingForm = null;
  });
})(jQuery);
</script>
</div>
     <!-- Wrapper End-->
{% endblock %}